# 概要
## OWASP 手机应用安全测试指南简介
新技术永远伴随着新的安全风险，手机操作系统也不例外。手机应用的安全性关注点在某些重要方面不同于传统的桌面软件。现代手机操作系统可以说比桌面操作系统存在更多的安全问题，并且在手机应用的开发过程中程序员不关注安全造成问题一直出现。数据存储，应用间通信，加密类API的正确用法和网络安全通信等因素需要去考虑。
### 移动手机安全重点领域
许多手机应用渗透测试人员都有网络和 web 应用渗透测试的背景，这种能力对于手机应用测试来说非常有价值。几乎所有手机应用都与服务端通信，这些服务遭受到攻击类型与桌面web应用差不多。手机应用的不同之处在于攻击面较少，因此针对注入和类似攻击的安全性更高。相反的是，我们必须优先考虑设备和网络上的数据保护以提高手机应用安全的安全性。

我们需要关注以下几个手机应用安全重点领域。

#### 本地数据存储
保护敏感数据(比如用户凭证和个人信息)是手机安全的关键。如果你不正确的使用了操作系统API，比如本地存储或应用间通信(IPC机制)，敏感数据可能会被运行在该设备的其他应用获取。也可能无意间通过云存储，备份数据，键盘缓存等泄漏了数据。另外，手机比其他设备更容易丢失和被盗，因此个人更有可能获得对该设备的物理访问权，更轻松的访问数据。

开发手机应用时，当需要存储用户数据时需要额外的小心。例如，使用密钥存储API和基于硬件安全的特性。

在 Android 设备上碎片化是需要特殊处理的问题。不是每个 Android 设备都包含基于硬件安全的存储特性，许多设备运行着低版本系统。应用需支持低版本系统时可能使用的是缺乏重要安全特性Android API。为了获得最大的安全性，最好的选择是即使丢失一部分用户也只开发支持当前API版本的应用。

#### 与可信端点通信
移动设备经常多种网络，包括使用公共 WIFI 与其他(恶意)终端进行数据共享。这为从简单到复杂和从旧到新的各种基于网络的攻击创造了机会。关键在于保持手机应用与远程服务端进行数据交换时的机密和可信。最基本要求在于手机应用必须使用 TLS 协议与适当的设置建立一个安全和加密的网络通信通道。

#### 认证和授权
在大多数场景下，发送用户信息给远程服务进行登录是整个手机应用架构下不可或缺的一部分。即使绝大多数的认证和授权逻辑在远程端点被处理但少部分实现在手机应用端也是挑战。和 web 应用不同，手机应用经常存储长时间会话 Token，并通过用户的设备身份验证功能(如指纹扫描)解锁。这不仅允许让带来用户体验更好(没有人喜欢输入复杂的密码)的快速登录功能并且带来了额外的复杂性和出错空间。

手机应用架构越来越多包括授权框架(比如 OAuth2), 使用第三方授权提供商提供的独立服务或外部授权程序代理应用的授权功能。使用 OAuth2 能用同设备上第三方应用(比如系统的浏览器)处理应用端的授权工作。安全测试人员必须清楚的知道不同授权框架和架构的优点和缺点。

#### 与系统交互
手机操作系统架构与传统桌面系统架构在某些方面有很重要的不同。比如所有的手机操作系统都实现了权限系统以控制特殊API的访问。他们也提供了或多(Android)或少(iOS)的进程间通信(IPC)机制以便应用间交换信号和数据。这些特殊的功能里面包含了一些陷阱。比如，如果IPC APIs被滥用的话，敏感数据和功能可能会无意间被运行在同台设备的其他应用所知道。

#### 代码质量和漏洞保护
传统的注入和内存管理缺陷因手机应用上较少的攻击面而不太常见。大多数的应用与受信任的后台服务和 UI 进行交互，因此，即使应用存在许多缓冲区溢出漏洞，这些漏洞通常也不会打开任何有效的攻击媒介。同样的情况浏览器中的web应用就非常多比如跨站脚本攻击。但是，总有例外。理论上手机应用的某些场景也会出现跨站脚本攻击，但是很少看到个人可以利用的跨站脚本攻击问题。关于更多的跨站脚本攻击问题信息可以查看[”跨站脚本攻击问题“](https://github.com/OWASP/owasp-mstg/blob/master/Document/0x04h-Testing-Code-Quality.md#cross-site-scripting-flaws-mstg-arch-2-and-mstg-platform-2) 中”代码质量测试“部分。

这种注入和内存管理缺陷的保护机制不意味者应用开发者可以草率的编写代码。遵循安全性最佳实践可令加固后的发行版本具有抵御篡改的能力。编译器和手机 SDK 提供的免费安全特性可增加安全性和抵御攻击。

#### 防篡改和逆向
在一次愉快的聊天中您不应该提及三件事：宗教，政治和代码混淆。许多安全专家直接取消了客户端保护机制。然而，在手机应用世界中软件保护控件被广泛应用，所以安全测试人员需要方法去应对这些保护措施。我们相信，如果采用明确的目标和切合实际的期望加上不可替代的安全控件是有益于客户端保护的。

## OWASP 移动应用安全检验标准
该指南跟 OWASP 手机应用安全检验标准(MASVS)密切相关。MASVS 定义了手机应用安全模型和列出了通用的安全需求清单。该标准可被用于架构师，开发人员，测试人员，安全专业人员，和消费者可用它来定义和理解手机应用的安全质量。MSTG 清单也是同样基于和依赖于 MASVS 的一系列安全需求清单，他们可以单独或组合使用达到不同的目标。

![owasp-mobile-overview](https://github.com/OWASP/owasp-mstg/blob/master/Document/Images/Chapters/0x03/owasp-mobile-overview.jpg)

比如，MASVS 需求能被用于手机应用计划和架构设计阶段而检查清单和测试指南可被用于开发期内或结束后的手工安全测试或基于模板的自动化安全测试阶段。在 [”手机应用安全测试“]() 章节部门我们会描述怎么基于检验清单和 MSTG 在手机应用上开展渗透测试。

## 移动应用安全测试指南概览
MSTG 包含 MASVS 所有需求清单中的的内容，主要分为以下三部分:

1. [“通用测试指南"]() 包含在手机应用安全方面的安全测试技术和主要漏洞分析技术。也包含与操作系统无关的其它场景的测试技术，比如认证方式和会话管理，网络通信和加解密。
2. ["Android测试指南"]() 覆盖了 Android 平台的手机安全测试，包含安全基础，安全测试案例，逆向工程技术和预防，篡改技术和预防。
3. ["iOS测试指南"]()覆盖了 iOS 平台的手机安全测试, 包含 iOS操作系统概述，安全测试，逆向工程技术和预防，篡改技术和预防。